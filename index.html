<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›™äººå¡ç‰Œå°æˆ°éŠæˆ²</title>
    <link rel="stylesheet" href="styles/main.css">
</head>

<body>
    <div class="background-animation"></div>

    <div class="main-container">
        <h1 class="game-title">
            <span class="glow">å¡ç‰Œ</span>
            <span class="glow delay-1">å°æˆ°</span>
            <span class="glow delay-2">ç«¶æŠ€å ´</span>
        </h1>

        <div class="subtitle">é›™äººæˆ°é¬¥ | ç­–ç•¥å°æ±º</div>

        <div class="button-container">
            <button class="main-button" id="startGameBtn">
                <span class="button-glow"></span>
                <span class="button-text">é€²å…¥éŠæˆ²</span>
            </button>

            <button class="main-button" id="tutorialBtn" style="border-color: #ff9900; color: #ff9900;">
                <span class="button-glow"
                    style="background: radial-gradient(circle, rgba(255, 153, 0, 0.4), transparent);"></span>
                <span class="button-text">æ–°æ‰‹æ•™å­¸</span>
            </button>

            <button class="main-button secondary" id="settingsBtn">
                <span class="button-glow"></span>
                <span class="button-text">è¨­å®š</span>
            </button>

            <button class="main-button" id="changelogBtn"
                style="border-color: var(--neon-accent); color: var(--neon-accent);">
                <span class="button-glow"
                    style="background: radial-gradient(circle, rgba(255, 255, 0, 0.4), transparent);"></span>
                <span class="button-text">æ›´æ–°æ—¥èªŒ</span>
            </button>

            <button class="main-button secondary" id="charListBtn" style="border-color: #00ff88; color: #00ff88;">
                <span class="button-glow"
                    style="background: radial-gradient(circle, rgba(0, 255, 136, 0.4), transparent);"></span>
                <span class="button-text">è§’è‰²åˆ—è¡¨</span>
            </button>
        </div>

        <div class="info-section">
            <div class="info-card">
                <div class="card-icon">ğŸ´</div>
                <h3>100+å¼µå¡ç‰Œ</h3>
                <p>åŒ…å«ç¥è©±ã€å‚³èªªã€å²è©©ç­‰å¤šç¨®ç¨€æœ‰åº¦</p>
            </div>

            <div class="info-card">
                <div class="card-icon">âš”ï¸</div>
                <h3>ç­–ç•¥å°æˆ°</h3>
                <p>é‹ç”¨æŠ€èƒ½èˆ‡å†·å»æ©Ÿåˆ¶åˆ¶å‹</p>
            </div>

            <div class="info-card">
                <div class="card-icon">ğŸ²</div>
                <h3>éš¨æ©ŸæŠ½å¡</h3>
                <p>åŸºæ–¼ç¨€æœ‰åº¦çš„æŠ½å¡ç³»çµ±</p>
            </div>
        </div>
    </div>

    <!-- è¨­å®šé¢æ¿ -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-content">
            <h2>éŠæˆ²è¨­å®š</h2>
            <button class="close-btn" id="closeSettings">âœ•</button>

            <div class="setting-item">
                <label for="musicVolume">éŸ³æ¨‚éŸ³é‡</label>
                <input type="range" id="musicVolume" min="0" max="100" value="50">
                <span class="volume-display">50%</span>
            </div>

            <div class="setting-item">
                <label for="sfxVolume">éŸ³æ•ˆéŸ³é‡</label>
                <input type="range" id="sfxVolume" min="0" max="100" value="70">
                <span class="volume-display">70%</span>
            </div>

            <div class="setting-item">
                <label>å‹•ç•«æ•ˆæœ</label>
                <div class="toggle-switch">
                    <input type="checkbox" id="animations" checked>
                    <span class="slider"></span>
                </div>
            </div>

            <div class="setting-item">
                <label>ç¨€æœ‰åº¦é¡¯ç¤º</label>
                <div class="toggle-switch">
                    <input type="checkbox" id="showRarity" checked>
                    <span class="slider"></span>
                </div>
            </div>

            <div class="rules-section">
                <h3>éŠæˆ²è¦å‰‡</h3>
                <ul>
                    <li>é›™æ–¹å„æŠ½å–5å¼µå¡ç‰Œä½œç‚ºåˆå§‹æ‰‹ç‰Œ</li>
                    <li>æŠ•æ“²ç¡¬å¹£æ±ºå®šå…ˆæ‰‹é †åº</li>
                    <li>é¸æ“‡1å¼µå¡ç‰Œæ”¾å…¥æˆ°é¬¥å€é–‹å§‹å°æˆ°</li>
                    <li>æ¯å›åˆå¯ä»¥ä½¿ç”¨1å€‹æŠ€èƒ½æˆ–æ™®æ”»</li>
                    <li>æ’¤é€€å¯ä»¥åˆ‡æ›æˆ°é¬¥å€å¡ç‰Œï¼Œä½†æœƒæ¶ˆè€—è©²å›åˆ</li>
                    <li>ç•¶ä¸€æ–¹æ²’æœ‰ä»»ä½•å¡ç‰Œæ™‚å³åˆ¤å®šè¼¸æ‰éŠæˆ²</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- æ›´æ–°æ—¥èªŒé¢æ¿ -->
    <div class="settings-panel" id="changelogPanel">
        <div class="settings-content">
            <h2>æ›´æ–°æ—¥èªŒ</h2>
            <button class="close-btn" id="closeChangelog">âœ•</button>
            <div class="changelog-body" style="line-height:2.5; font-size:1.1rem; color:#ccc;">
                <p
                    style="color:var(--neon-accent); font-weight:bold; font-size:1.4rem; border-bottom:1px solid rgba(255,255,0,0.2); margin-bottom:10px;">
                    ç‰ˆæœ¬: beta 2.1</p>
                <p><span style="color:#00ff88;">ğŸŸ¢ æœ¬ç‰ˆå¢å¼·:</span> ç„¡</p>
                <p><span style="color:#ff3333;">ğŸ”´ æœ¬ç‰ˆå‰Šå¼±:</span> ç„¡</p>
                <p><span style="color:#66ccff;">ğŸ”µ å¹³è¡¡æ€§èª¿æ•´:</span> ç„¡</p>
            </div>
        </div>
    </div>

    <!-- è§’è‰²åˆ—è¡¨é¢æ¿ -->
    <div class="settings-panel" id="charListPanel">
        <div class="settings-content" style="max-width: 1200px; width: 95%;">
            <h2>è§’è‰²åœ–é‘‘</h2>
            <button class="close-btn" id="closeCharList">âœ•</button>
            <div id="charListContainer"
                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                <!-- ç”± JS å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script src="scripts/data.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log("Homepage logic initialized");

            // Helper to toggle panels
            const togglePanel = (id, active) => {
                const el = document.getElementById(id);
                if (el) {
                    if (active) el.classList.add('active');
                    else el.classList.remove('active');
                } else {
                    console.error("Panel not found:", id);
                }
            };

            // Event Listeners
            const safeAddListener = (id, type, callback) => {
                const el = document.getElementById(id);
                if (el) el.addEventListener(type, callback);
                else console.warn("Element not found for listener:", id);
            };

            safeAddListener('startGameBtn', 'click', () => {
                window.location.href = 'game.html';
            });

            safeAddListener('tutorialBtn', 'click', () => {
                window.location.href = 'game.html?mode=tutorial';
            });

            safeAddListener('settingsBtn', 'click', () => togglePanel('settingsPanel', true));
            safeAddListener('closeSettings', 'click', () => togglePanel('settingsPanel', false));

            safeAddListener('changelogBtn', 'click', () => togglePanel('changelogPanel', true));
            safeAddListener('closeChangelog', 'click', () => togglePanel('changelogPanel', false));

            safeAddListener('charListBtn', 'click', () => {
                renderCharacterList();
                togglePanel('charListPanel', true);
            });
            safeAddListener('closeCharList', 'click', () => togglePanel('charListPanel', false));

            // Volume Logic
            const musicInput = document.getElementById('musicVolume');
            const sfxInput = document.getElementById('sfxVolume');

            if (musicInput) {
                musicInput.addEventListener('input', (e) => {
                    const val = e.target.value;
                    const display = e.target.nextElementSibling;
                    if (display) display.textContent = val + '%';
                    localStorage.setItem('musicVolume', val);
                });
            }

            if (sfxInput) {
                sfxInput.addEventListener('input', (e) => {
                    const val = e.target.value;
                    const display = e.target.nextElementSibling;
                    if (display) display.textContent = val + '%';
                    localStorage.setItem('sfxVolume', val);
                });
            }

            // Load saved settings
            const musicVolume = localStorage.getItem('musicVolume') || 50;
            const sfxVolume = localStorage.getItem('sfxVolume') || 70;

            if (musicInput) {
                musicInput.value = musicVolume;
                const display = musicInput.nextElementSibling;
                if (display) display.textContent = musicVolume + '%';
            }
            if (sfxInput) {
                sfxInput.value = sfxVolume;
                const display = sfxInput.nextElementSibling;
                if (display) display.textContent = sfxVolume + '%';
            }

            // æ¸²æŸ“è§’è‰²åˆ—è¡¨
            function renderCharacterList() {
                const container = document.getElementById('charListContainer');
                if (!container || container.children.length > 0) return;

                if (typeof CHARACTERS === 'undefined') {
                    console.error("CHARACTERS data not loaded!");
                    return;
                }

                CHARACTERS.forEach(char => {
                    const card = document.createElement('div');
                    card.style.cssText = `
                        background: rgba(255,255,255,0.05);
                        border: 1px solid rgba(255,255,255,0.1);
                        border-radius: 10px;
                        padding: 15px;
                        display: flex;
                        flex-direction: column;
                        gap: 10px;
                    `;

                    const rarityColors = {
                        'ä¸€èˆ¬': '#808080',
                        'ç¨€æœ‰': '#00b0f0',
                        'å²è©©': '#9900ff',
                        'å‚³è£': '#ffc000',
                        'å‚³èªª': '#ffc000',
                        'ç¥è©±': '#ff0000'
                    };
                    const rColor = rarityColors[char.rarity] || '#fff';

                    card.innerHTML = `
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <span style="font-weight:bold; font-size:1.2rem; color:#fff;">${char.name}</span>
                            <span style="background:${rColor}; color:#fff; padding:2px 8px; border-radius:4px; font-size:0.8rem;">${char.rarity}</span>
                        </div>
                        <div style="display:grid; grid-template-columns:1fr 1fr; font-size:0.9rem; color:#aaa;">
                            <span>HP: ${char.hp}</span>
                            <span>ATK: ${char.atk}</span>
                        </div>
                        <div style="border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                            <div style="color:var(--neon-primary); font-size:0.85rem; font-weight:bold; margin-bottom:5px;">æŠ€èƒ½:</div>
                            ${char.skills.map(s => `
                                <div style="font-size:0.8rem; background:rgba(0,0,0,0.3); padding:4px 8px; border-radius:4px; margin-bottom:4px;">
                                    <span style="color:#fff;">${s.name}</span> <span style="color:#aaa;">(CD:${s.cooldown || 0})</span>
                                </div>
                            `).join('')}
                        </div>
                        ${char.passive ? `
                            <div style="border-top:1px solid rgba(255,255,255,0.1); padding-top:10px;">
                                <div style="color:var(--neon-secondary); font-size:0.85rem; font-weight:bold; margin-bottom:5px;">è¢«å‹•:</div>
                                <div style="font-size:0.8rem; color:#ccc;">${char.passive.name}</div>
                            </div>
                        ` : ''}
                    `;
                    container.appendChild(card);
                });
            }
        });
    </script>
</body>

</html>